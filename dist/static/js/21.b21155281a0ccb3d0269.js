webpackJsonp([21],{LHBj:function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=a("dqLT"),s=a.n(e),o=a("NHnr"),n={name:"Header",data:function(){return{user_info:{},is_dialog_token:!1,is_dialog_spit_slot:!1,is_dialog_about:!1,is_visible_update_password:!1,token:"***********************************************************",update_password_loading:!1,form_data:{},form_errors:{}}},mounted:function(){this.user_info=this.$store.state.user_info},methods:{get_data:function(){var t=this;this.$c_master.get("user/user/info").then(function(i){t.user_info=i.data,t.$store.state.user_info=i.data}).catch(function(t){})},get_token:function(){var t=this;this.$c_master.get("user/user/token").then(function(i){t.token=i.data.token}).catch(function(t){})},on_logout:function(){var t=this;o.default.$confirm("确认退出","退出",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info",center:!0}).then(function(){t.$store.commit("logout"),t.$router.push("login")})},on_login:function(){s.a.login()},on_open_api_docs:function(){var t=window.location.protocol+"//"+window.location.host+"/api-docs";window.open(t)},on_help:function(){window.open("https://zhuanlan.zhihu.com/p/34191320")},on_spilt_:function(){window.open("https://github.com/open-cmdb/cmdb/issues")},open_url:function(t){window.open(t)},on_submit_update_password:function(){var t=this;this.update_password_loading=!0,this.$c_master.post("mgmt/user/update-password",this.form_data).then(function(i){t.update_password_loading=!1,t.is_visible_update_password=!1,t.$message.success("修改成功")}).catch(function(i){t.update_password_loading=!1})}}},r={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticStyle:{"background-color":"#409EFF",padding:"0px 20px",display:"flex","align-items":"center","justify-content":"space-between",height:"80px"}},[t._m(0),t._v(" "),a("div",[a("ul",{staticClass:"c_ul"},[a("li",{staticClass:"c_li",on:{click:t.on_open_api_docs}},[a("i",{staticClass:"fa fa-file-text",staticStyle:{"margin-right":"5px"},attrs:{"aria-hidden":"true"}}),t._v("API文档")]),t._v(" "),a("li",{staticClass:"c_li",on:{click:function(i){t.open_url("https://zhuanlan.zhihu.com/p/34191320")}}},[a("i",{staticClass:"fa fa-question-circle",staticStyle:{"margin-right":"5px"},attrs:{"aria-hidden":"true"}}),t._v("帮助")]),t._v(" "),a("li",{staticClass:"c_li",on:{click:function(i){t.open_url("https://github.com/open-cmdb/cmdb")}}},[a("i",{staticClass:"fa fa-code",staticStyle:{"margin-right":"5px"},attrs:{"aria-hidden":"true"}}),t._v("源代码")]),t._v(" "),a("li",{staticClass:"c_li",on:{click:function(i){t.open_url("https://github.com/open-cmdb/cmdb/issues")}}},[a("i",{staticClass:"fa fa-comment",staticStyle:{"margin-right":"5px"},attrs:{"aria-hidden":"true"}}),t._v("我要吐槽")]),t._v(" "),a("li",{staticClass:"c_li"},[a("el-dropdown",{},[a("span",{staticClass:"el-dropdown-link",staticStyle:{"font-size":"16px",color:"#FFF"}},[a("i",{staticClass:"fa fa-user-circle-o",staticStyle:{"margin-right":"5px"}}),t._v(t._s(t.user_info.name?t.user_info.name:"未登录")+"\n            "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("span",{staticStyle:{width:"100%"},on:{click:function(i){t.is_visible_update_password=!0}}},[a("i",{staticClass:"fa fa-key",attrs:{"aria-hidden":"true"}}),t._v("修改密码")])]),t._v(" "),t.user_info.username?a("el-dropdown-item",[a("span",{staticStyle:{width:"100%"},on:{click:t.on_logout}},[a("i",{staticClass:"fa fa-sign-out",attrs:{"aria-hidden":"true"}}),t._v("退 出")])]):a("el-dropdown-item",[a("span",{staticStyle:{width:"100%"},on:{click:t.on_login}},[a("i",{staticClass:"fa fa-sign-in",attrs:{"aria-hidden":"true"}}),t._v("登 录")])])],1)],1)],1)])]),t._v(" "),a("el-dialog",{attrs:{title:"查看API Token",visible:t.is_dialog_token,width:"600px"},on:{"update:visible":function(i){t.is_dialog_token=i}}},[a("el-alert",{attrs:{title:"请妥善保存您的API Token",closable:!1,type:"warning"}}),t._v(" "),a("div",{staticStyle:{padding:"0px 20px","padding-top":"20px"}},[a("span",[t._v(t._s(t.token))]),t._v(" "),a("i",{staticClass:"fa fa-eye fa-lg",staticStyle:{float:"right","line-height":"24px"},attrs:{"aria-hidden":"true"},on:{click:t.get_token}})]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(i){t.is_dialog_token=!1}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{width:"700px",title:"重置密码",visible:t.is_visible_update_password},on:{"update:visible":function(i){t.is_visible_update_password=i}}},[a("el-form",{staticStyle:{"margin-right":"50px"},attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"新密码:",error:t.form_errors.password,required:""}},[a("el-input",{attrs:{type:"password",autofocus:""},nativeOn:{keydown:function(i){if(!("button"in i)&&t._k(i.keyCode,"enter",13,i.key))return null;t.on_submit_update_password(null)}},model:{value:t.form_data.password,callback:function(i){t.$set(t.form_data,"password",i)},expression:"form_data.password"}})],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.update_password_loading},on:{click:function(i){t.on_submit_update_password(null)}}},[t._v("提交")])],1)],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",[i("span",{staticStyle:{"margin-left":"50px","font-family":"Montserrat-Regular","letter-spacing":"2px","font-weight":"800",color:"#FFFFFF","font-size":"36px",height:"100%",display:"inline-block","box-sizing":"border-box","vertical-align":"middle"}},[this._v("CMDB")])])}]};var l=a("VU/8")(n,r,!1,function(t){a("fT+q")},"data-v-11610a5c",null);i.default=l.exports},"fT+q":function(t,i){}});
//# sourceMappingURL=21.b21155281a0ccb3d0269.js.map