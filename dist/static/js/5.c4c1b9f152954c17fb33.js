webpackJsonp([5],{"1vrE":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),i=r.n(a),l=r("gyMJ"),s={name:"change-table",data:function(){return{is_visible:!0,loading:!1,form_data:this.is_create?{name:"",alias:"",readme:"",fields:[{name:"",alias:"",readme:"",is_multi:!1,required:!1}]}:JSON.parse(i()(this.data)),errors:{}}},props:["is_create","data"],mounted:function(){},methods:{on_close:function(){this.$el.parentNode.removeChild(this.$el),this.$destroy()},on_add_field:function(e,t){this.form_data.fields.splice(t+1,0,{name:"",alias:"",readme:"",is_multi:!1,required:!1}),this.errors.fields&&this.errors.fields.splice(t+1,0,{})},on_delete_filed:function(e,t){console.log("this.from_data:",this.form_data),this.form_data.fields.splice(t,1),this.errors.fields&&this.errors.fields.splice(t,1)},on_submit:function(){var e=this;this.is_create?(this.loading=!0,l.c.post("mgmt/table",this.form_data).then(function(t){e.loading=!1,e.$message.success("添加成功 请重启服务器"),e.errors={},e.$emit("add_table",t.data),e.on_close()}).catch(function(t){e.loading=!1,e.errors=t.response.data})):l.c.put("mgmt/table/"+this.data.name,this.form_data).then(function(t){for(var r in e.$message.success("修改成功"),e.errors={},e.form_data)e.data[r]=e.form_data[r];e.on_close()}).catch(function(t){e.errors=t.response.data})}}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{width:"900px",title:e.data?"修改表 "+e.data.name:"创建表",visible:e.is_visible},on:{"update:visible":function(t){e.is_visible=t},close:e.on_close}},[r("el-form",{staticStyle:{"margin-right":"30px"},attrs:{size:"small","label-width":"60px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"表名:",error:String(e.errors.name?e.errors.name:"")}},[r("el-input",{model:{value:e.form_data.name,callback:function(t){e.$set(e.form_data,"name",t)},expression:"form_data.name"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"别名:",error:String(e.errors.alias?e.errors.alias:"")}},[r("el-input",{model:{value:e.form_data.alias,callback:function(t){e.$set(e.form_data,"alias",t)},expression:"form_data.alias"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"自诉:",error:String(e.errors.readme?e.errors.readme:"")}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form_data.readme,callback:function(t){e.$set(e.form_data,"readme",t)},expression:"form_data.readme"}})],1)],1),e._v(" "),e._l(e.form_data.fields,function(t,a){return r("el-form",{key:a,attrs:{size:"small",inline:!0,"label-width":"60px"}},[r("el-form-item",{staticStyle:{"margin-right":"0px"},attrs:{label:"字段:"}}),e._v(" "),r("el-form-item",{staticStyle:{width:"80px"},attrs:{error:String(e.errors.fields&&e.errors.fields[a].name?e.errors.fields[a].name:"")}},[r("el-input",{attrs:{placeholder:"字段名"},model:{value:t.name,callback:function(r){e.$set(t,"name",r)},expression:"item.name"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"80px"},attrs:{error:String(e.errors.fields&&e.errors.fields[a].alias?e.errors.fields[a].alias:"")}},[r("el-input",{attrs:{placeholder:"别名"},model:{value:t.alias,callback:function(r){e.$set(t,"alias",r)},expression:"item.alias"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"140px"},attrs:{error:String(e.errors.fields&&e.errors.fields[a].type?e.errors.fields[a].type:"")}},[r("el-select",{attrs:{placeholder:"选择字段类型"},model:{value:t.type,callback:function(r){e.$set(t,"type",r)},expression:"item.type"}},[r("el-option",{attrs:{label:"字符串",value:0}}),e._v(" "),r("el-option",{attrs:{label:"整数",value:1}}),e._v(" "),r("el-option",{attrs:{label:"浮点数",value:2}}),e._v(" "),r("el-option",{attrs:{label:"日期时间",value:3}}),e._v(" "),r("el-option",{attrs:{label:"日期",value:4}}),e._v(" "),r("el-option",{attrs:{label:"布尔",value:5}}),e._v(" "),r("el-option",{attrs:{label:"IP地址",value:6}})],1)],1),e._v(" "),r("el-form-item",{attrs:{error:String(e.errors.fields&&e.errors.fields[a].required?e.errors.fields[a].required:"")}},[r("el-checkbox",{attrs:{disabled:t.is_multi},model:{value:t.required,callback:function(r){e.$set(t,"required",r)},expression:"item.required"}},[e._v("必填")])],1),e._v(" "),r("el-form-item",{attrs:{error:String(e.errors.fields&&e.errors.fields[a].is_multi?e.errors.fields[a].is_multi:"")}},[r("el-checkbox",{model:{value:t.is_multi,callback:function(r){e.$set(t,"is_multi",r)},expression:"item.is_multi"}},[e._v("多值")])],1),e._v(" "),r("el-form-item",{attrs:{error:String(e.errors.fields&&e.errors.fields[a].readme?e.errors.fields[a].readme:"")}},[r("el-input",{staticStyle:{width:"176px"},attrs:{placeholder:"自述"},model:{value:t.readme,callback:function(r){e.$set(t,"readme",r)},expression:"item.readme"}})],1),e._v(" "),r("el-form-item",[r("el-button",{staticStyle:{margin:"0px 1px"},attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(r){e.on_add_field(t,a)}}}),e._v(" "),r("el-button",{staticStyle:{margin:"0px 1px"},attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){e.on_delete_filed(t,a)}}})],1)],1)}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:0==e.form_data.fields.length,expression:"form_data.fields.length==0"}]},[r("el-button",{staticStyle:{margin:"10px 60px"},attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.on_add_field({},0)}}},[e._v("添加字段")])],1),e._v(" "),r("el-form",{staticStyle:{"margin-right":"30px"},attrs:{"label-width":"60px"}},[r("el-form-item",[r("el-button",{staticStyle:{width:"100%"},attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.on_submit}},[e._v("提交")])],1)],1)],2)},staticRenderFns:[]};var n=r("VU/8")(s,o,!1,function(e){r("NApK")},"data-v-e5dc0884",null);t.default=n.exports},NApK:function(e,t){}});
//# sourceMappingURL=5.c4c1b9f152954c17fb33.js.map